% -*- encoding: utf-8 -*-

\documentclass[12pt,titlepage,twoside,openright,dvipdfmx]{jsbook}

\interfootnotelinepenalty=10000

\usepackage{amsmath,stmaryrd,amssymb,amsthm,algorithm,algpseudocode,color,bcprules,url}
\usepackage{proof}
\usepackage{enumerate}
\usepackage{mathtools}
\usepackage{listings}
\usepackage{okumacro-ruby}
% \makeindex

\usepackage{enumerate}
\usepackage[inference]{semantic}
\usepackage[dvipdfmx]{graphicx}

\title{『プログラミング言語の形式的意味論』正誤表}
\author{末永 幸平 \and 勝股 審也 \and 中澤 巧爾 \and 西村 進 \and 前田 敦司}
\date{最終更新: \today}

%%%%%%%%%%%%%%%% Definitions of global commands %%%%%%%%%%%%%%%%
% DON'T ADD A COMMAND DEFINITION HERE.  Add your command definition in
% xxx-def.tex

% Name of the languages used throughout the book.
\newcommand\IMP{\mathbf{IMP}}
\newcommand\ASSN{\mathbf{Assn}}
\newcommand\REC{\mathbf{REC}}

% Environments used in the book
\theoremstyle{definition}
\newtheorem{theorem}{定理}[chapter]
\newtheorem{proposition}[theorem]{命題}
\newtheorem{lemma}[theorem]{補題}
\newtheorem{fact}[theorem]{事実}
\newtheorem{exercise}[theorem]{問題}
\newtheorem{corollary}[theorem]{系}
\newtheorem{example}[theorem]{例}
\newtheorem*{exampleN}{例} % \cmt{西村}{番号なしの例のための環境}
\newtheorem*{definition}{定義}
\newtheorem*{notation}{記法}

\input{defs}

\begin{document}

\maketitle
% \tableofcontents

\section*{まえがき}

\begin{itemize}
\item 「本書の使い方」の段落において第13章と第14章に言及がありますが，本翻訳ではこれらの章は割愛されています．
\end{itemize}

\section*{第1章}

\begin{itemize}
\item P.3, 1.2節，第2段落: 「$X$と$Y$が等しいことを示すの方法の一つである」とあるのは「$X$と$Y$が等しいことを示す方法の一つである」の誤りです．
\item P.9, 1.3節，第4段落: 「$X$から$Y$の部分関数」とあるのは「$X$から$Y$への部分関数」の誤りです．
\end{itemize}

\section*{第2章}

\begin{itemize}
  \item P.22, 2.3節: $b_1 \land b_2$ のための操作的意味論の3つ目の規則が
    \infrule
    {\tuple{b_0, \sigma} \arrow \Ttrue \andalso \tuple{b_1, \sigma} \arrow \Ttrue}
    {\tuple{b_0 \land b_1, \sigma} \arrow \Tfalse}
    とあるのは
    \infrule
    {\tuple{b_0, \sigma} \arrow \Ttrue \andalso \tuple{b_1, \sigma} \arrow \Ttrue}
    {\tuple{b_0 \land b_1, \sigma} \arrow \Ttrue}
    の誤りです．
  \item P.24, 問題2.7: 「$w \sim \Cif\ b\ \Cthen\ (c;w)\ \Celse\ \Cskip$」とあるのは「$w \equiv \Cwhile\ \Ttrue\ \Cdo\ \Cskip$」の誤りです．
  \item P.25, 2.5節，第3段落: 「状態を変えずにすぐ停止しするだろう」とあるのは「状態を変えずにすぐ停止するだろう」の誤りです．
  \item P.29, 2.6節, 第2段落:
    「状態$\sigma$において$a_0$の1ステップの評価によって式$a_0'$と状
    態$\sigma'$が得られるとき，$a_0+a_1$の状態$\sigma$の下での1ステップ
    の評価によって式$a_0'+a_1$と状態$\sigma'$が得られる．」は
    「状態$\sigma$において$a_0$の1ステップの評価によって式$a_0'$と状
    態$\sigma$が得られるとき，$a_0+a_1$の状態$\sigma$の下での1ステップ
    の評価によって式$a_0'+a_1$と状態$\sigma$が得られる．」の誤りです．
\end{itemize}

\section*{第3章}

\newcommand{\AexpBinPropB}{
  \forall{a_0,a_1\in\mathbf{Aexp},\sigma\in\Sigma,m,n\in\mathbf{N}}. \\ &
  \tuple{a_0,\sigma}\rightarrow m \AND
  \tuple{a_1,\sigma}\rightarrow n \AND
}

\newcommand{\BexpBinProp}{
  \forall{b_0,b_1\in\mathbf{Bexp},\sigma\in\Sigma,t\in\mathbf{T}}. \\ &
  \tuple{b_0,\sigma}\rightarrow t_0 \AND P(b_0,\sigma,t_0) \AND
  \tuple{b_1,\sigma}\rightarrow t_1 \AND P(b_1,\sigma,t_1) \AND
}  

\begin{itemize}
\item P.35, 3.2節, 第2段落: 「すべての位置$X$について」は「すべてのプログラム変数$X$について」の誤りです．
\item P.41,
  3.3節:「$\tuple{\text{Euclid},\sigma''}\rightarrow\sigma''$とな
  る$\sigma''$が存在する」は
  「$\tuple{\text{Euclid},\sigma''}\rightarrow\sigma'$となる$\sigma'$が
  存在する」の誤りです．
\item P.46, 3.4節:「性質が偽となる最小の導出が存在するという仮定」は「性質が偽となる極小の導出が存在するという仮定」の誤りです．
  また，命題3.12の証明において，「最小の導出$d$が存在して」は「極小の導出$d$が存在して」の誤り，「$d$の最小性に矛盾する」は「$d$の極小性に矛盾する」です．
\item P.46, 3.4節, 命題3.12の証明:「$\exists{\sigma,\sigma'\in\Sigma}.\;\Vdash\tuple{w,\sigma}\rightarrow\sigma'$」は「$\exists{\sigma,\sigma'\in\Sigma}.\; d \Vdash\tuple{w,\sigma}\rightarrow\sigma'$」の誤りです．
\item P.46, 3.4節, 命題3.12の証明:
  \[
    d =
    \infer
    {\tuple{\mathbf{while\ true\ do}\ c, \sigma}\rightarrow \sigma'}
    {
      \infer
      {\tuple{\mathbf{true},\sigma}\rightarrow\mathbf{true}}
      {\vdots}
      &
      \infer
      {\tuple{c,\sigma}\rightarrow\sigma''}
      {\vdots}
      &
      \infer
      {\tuple{\mathbf{while\ true\ do}\ c,\sigma''}\rightarrow\sigma'}
      {\vdots}
    }
  \]
  は
  \[
    d =
    \infer
    {\tuple{\mathbf{while\ true\ do}\ \Cskip, \sigma}\rightarrow \sigma'}
    {
      \infer
      {\tuple{\mathbf{true},\sigma}\rightarrow\mathbf{true}}
      {\vdots}
      &
      \infer
      {\tuple{\Cskip,\sigma}\rightarrow\sigma}
      {\vdots}
      &
      \infer
      {\tuple{\mathbf{while\ true\ do}\ \Cskip,\sigma}\rightarrow\sigma'}
      {\vdots}
    }
  \]
  の誤りです．
\item P.46, 3.5節:「コマンド内で，代入の左辺に現れる位置の集合」は「コマンド内で，代入の左辺に現れるプログラム変数の集合」の誤りです．
\item P.47, 3.5節:「実際，整礎な集合の任意の空でない部分集合には最小の
  要素が存在するという命題3.7の証明の中では，暗黙のうちに自然数の帰納的
  な定義を用いて，空でない集合中に最小の要素を持つ列を構成した．」は
  「実際，整礎な集合の任意の空でない部分集合には極小の要素が存在すると
  いう命題3.7の証明の中では，暗黙のうちに自然数の帰納的な定義を用いて，
  空でない集合中に極小の要素を持つ列を構成した．」の誤りです．
\item P.47, 問題3.13:「右辺の中に現れる位置の集合」は「右辺の中に現れる
  プログラム変数の集合」の誤りです．
\end{itemize}

\section*{第4章}

\begin{itemize}
  \item P.53, 4.2節: 以下の規則
  \[
    \infer
    {\mathbf{if}\ b\ \mathbf{then}\ c_0\ \mathbf{else}\ c_1:\mathbf{Com}}
    {b:\mathbf{Bexp} & c_0:\mathbf{Com} & c1:\mathbf{Com}}
  \]
  は
  \[
    \infer
    {\mathbf{if}\ b\ \mathbf{then}\ c_0\ \mathbf{else}\ c_1:\mathbf{Com}}
    {b:\mathbf{Bexp} & c_0:\mathbf{Com} & c_1:\mathbf{Com}}
  \]
  の誤りです．
\item P.55, 4.3.2節: $p(\Ttrue, \sigma,\Ttrue)$は$P(\Ttrue, \sigma, \Ttrue)$の誤りです．
\item P.56, 上から9行目:
  $m \not\le n \Rightarrow P(a_0 \not\le a_1,\sigma,\mathbf{false})$
  は
  $m \not\le n \Rightarrow P(a_0 \le a_1,\sigma,\mathbf{false})$
  の誤りです．
\item P.56, 上から14行目:
  \[
    \begin{array}{ll}
    \AND\\
    \forall{b_0,b_1\in\mathbf{Bexp},\sigma\in\Sigma,t\in\mathbf{T}}.\\
      \tuple{b_0,\sigma}\rightarrow t_0 \AND P(b_0,\sigma,t_0) \AND \tuple{b_1,\sigma}\rightarrow t_1 \AND P(b_1,\sigma,t_1) \AND P(b_0\wedge b_1,\sigma, t_0\wedge t_1)\\
      \AND\\
      \forall{b_0,b_1\in\mathbf{Bexp},\sigma\in\Sigma,t\in\mathbf{T}}.\\
      \tuple{b_0,\sigma}\rightarrow t_0 \AND P(b_0,\sigma,t_0) \AND \tuple{b_1,\sigma}\rightarrow t_1 \AND P(b_1,\sigma,t_1) \AND P(b_0\vee b_1,\sigma, t_0\vee t_1) \rbrack
    \end{array}
  \]
  は
  \[
    \begin{array}{ll}
    \AND\\
      \forall{b_0,b_1\in\mathbf{Bexp},\sigma\in\Sigma,t_0,t_1\in\mathbf{T}}.\\
      \tuple{b_0,\sigma}\rightarrow t_0 \AND P(b_0,\sigma,t_0) \AND \tuple{b_1,\sigma}\rightarrow t_1 \AND P(b_1,\sigma,t_1) \implies P(b_0\wedge b_1,\sigma, t_0\wedge t_1)\\
      \AND\\
      \forall{b_0,b_1\in\mathbf{Bexp},\sigma\in\Sigma,t_0,t_1\in\mathbf{T}}.\\
      \tuple{b_0,\sigma}\rightarrow t_0 \AND P(b_0,\sigma,t_0) \AND \tuple{b_1,\sigma}\rightarrow t_1 \AND P(b_1,\sigma,t_1) \implies P(b_0\vee b_1,\sigma, t_0\vee t_1) \rbrack
    \end{array}
  \]
  の誤りです．
\item P.58, 上から9行目:
  「$c_0,c_1\in\mathbf{Com}, \sigma,\sigma'\in\Sigma$とする．」は
  「$c_0,c_1\in\mathbf{Com}, \sigma,\sigma',\sigma''\in\Sigma$とする．」
  の誤りです．
\item P.60, 問題4.10:
  \[
    \tuple{c_0;c_1,\sigma}\rightarrow_1^*\sigma'
    {{\iff}_{\mathit{def}}}\
    \exists{\sigma''}.\;\tuple{c_0,\sigma}\rightarrow_1^*\sigma''\AND
    \tuple{c_1,\sigma''}\rightarrow_1^*\sigma'
  \]
  は
  \[
    \tuple{c_0;c_1,\sigma}\rightarrow_1^*\sigma' \iff
    \exists{\sigma''}.\;\tuple{c_0,\sigma}\rightarrow_1^*\sigma''\AND
    \tuple{c_1,\sigma''}\rightarrow_1^*\sigma'
  \]
  の誤りです．（左辺に現れる関
  係${\rightarrow}_1^{*}$は${\rightarrow}_1$の反射推移閉包としてすでに
  定義されており，ここは左辺の関係を右辺で定義するという趣旨ではありま
  せんでした．）
\item P.62, 命題4.12 の証明の直後の文章において
  \begin{quote}
    (i)と(i)から$A$が，$R$導出の存在する要素の集合$I_R$と等しいことがい
    える．そして(i)はまさに$I_R$が$\widehat{R}$の不動点であることを表し
    ている．さらに，(i)から$I_R$が$\widehat{R}$の\emph{最小不動
      点 (least fixed point)}であること，すなわち
    \[
      \widehat{R}(B) = B\Rightarrow I_R\subseteq B
    \]
    が言える．
  \end{quote}
  とあるのは
  \begin{quote}
    (i) と (iii) から$A$が，$R$導出の存在する要素の集合$I_R$と等しいこ
    とがいえる．そして (ii) はまさに$I_R$が$\widehat{R}$の不動点である
    ことを表している．さらに，(iii) から$I_R$が$\widehat{R}$の\emph{最
      小不動点 (least fixed point)}であること，すなわち
    \[
      \widehat{R}(B) = B\Rightarrow I_R\subseteq B
    \]
    がいえる．
  \end{quote}
  の誤りです．（証明中のアイテムへの参照が壊れておりました．．．）
\end{itemize}

\section*{第5章}

\begin{itemize}
\item P.68,
  「$\mathbf{Bexp}$の表示」の部分において，「\termbooleanexpression{}の
  意味関数は，連言$\wedge_T$,
  選言$\vee_T$，否定$\neg_T$という真偽値の集合$T$上の論理演算を用いて与
  えられる．」は「\termbooleanexpression{}の意味関数は，連
  言$\wedge_T$,
  選言$\vee_T$，否定$\neg_T$という真偽値の集合$\mathbf{T}$上の論理演算
  を用いて与えられる．」の誤りです．
\item P.69, 「$\mathbf{Com}$の表示」の部分において，
  \begin{align*}
      \denotation{C}{w} = {} & \{(\sigma,\sigma')\mid  \denotation{B}{b}\sigma=\mathbf{true} \AND (\sigma,\sigma')\in\denotation{C}{c;w}\}\cup {}\\
                             & \{(\sigma,\sigma')\mid  \denotation{B}{b}\sigma=\mathbf{false}\} \\
      = {} & \{(\sigma,\sigma')\mid  \denotation{B}{b}\sigma=\mathbf{true} \AND (\sigma,\sigma')\in \denotation{C}{w} \circ \denotation{C}{c} \}\cup {}\\
                             & \{(\sigma,\sigma')\mid  \denotation{B}{b}\sigma=\mathbf{false}\}
  \end{align*}
  は
  \begin{align*}
      \denotation{C}{w} = {} & \{(\sigma,\sigma')\mid  \denotation{B}{b}\sigma=\mathbf{true} \AND (\sigma,\sigma')\in\denotation{C}{c;w}\}\cup {}\\
                             & \{(\sigma,\sigma)\mid  \denotation{B}{b}\sigma=\mathbf{false}\} \\
      = {} & \{(\sigma,\sigma')\mid  \denotation{B}{b}\sigma=\mathbf{true} \AND (\sigma,\sigma')\in \denotation{C}{w} \circ \denotation{C}{c} \}\cup {}\\
                             & \{(\sigma,\sigma)\mid  \denotation{B}{b}\sigma=\mathbf{false}\}
  \end{align*}
  の誤りです．また，これに続く
  \begin{align*}
    \varphi = {} & \{(\sigma,\sigma')\mid \beta(\sigma)=\mathbf{true} \AND
                   (\sigma,\sigma')\in \varphi\circ\gamma \} \cup {} \\
                 & \{(\sigma,\sigma')\mid \beta(\sigma)=\mathbf{false} \}
  \end{align*}
  は
  \begin{align*}
    \varphi = {} & \{(\sigma,\sigma')\mid \beta(\sigma)=\mathbf{true} \AND
                   (\sigma,\sigma')\in \varphi\circ\gamma \} \cup {} \\
                 & \{(\sigma,\sigma)\mid \beta(\sigma)=\mathbf{false} \}
  \end{align*}
  の誤りです．
\end{itemize}

\section*{謝辞}

本翻訳の誤りをご報告いただいた以下の方々に深く感謝申し上げます: gaxiiiiiiiiiiii様，hackermaskee様，衣笠公陽様．

\end{document}
